all:
COMMON = $(BASEDIR)/common
CLIENT = $(BASEDIR)/client
SERVER = $(BASEDIR)/server

MACHINE = $(shell uname -s)
ifeq ($(MACHINE),)
MACHINE = Windows
else
ifeq ($(shell echo $(MACHINE) | cut -c 1-5),MINGW)
MACHINE = Windows
endif
endif

FLAGS_SDL = $(shell sdl-config --cflags)
LIBS_SDL = $(shell sdl-config --libs)
LIBS_SDL_OTHER = -lSDL_image -lSDL_ttf -lSDL_net -lSDL_mixer

ifeq ($(MACHINE),Darwin)
FLAGS_GL = -FOpenGL
LIBS_GL = -framework OpenGL
else
ifeq ($(MACHINE),Windows)
LIBS_GL = -lopengl32
else
LIBS_GL = -L/usr/X11/lib/ -lGL
endif
endif

INCLUDES = -I$(BASEDIR)

CXXFLAGS += -Wall -fno-rtti -g
LDFLAGS += $(CXXFLAGS)
CXXFLAGS += $(FLAGS_SDL) $(FLAGS_GL) $(INCLUDES)
LIBS = $(LIBS_SDL)
ifeq ($(MACHINE),Windows)
LIBS += -lwsock32
endif
CLIENTLIBS = $(LIBS_GL) $(LIBS) $(LIBS_SDL_OTHER)

H_GL	= $(CLIENT)/compat_gl.h
H_SDL	= $(COMMON)/compat_sdl.h

H_COMMONSDL	= $(COMMON)/CommonSDL.hpp
H_LMEXCEPTION	= $(COMMON)/LMException.hpp

H_CLIENTNETWORK		= $(CLIENT)/ClientNetwork.hpp
H_CLIENTSDL		= $(CLIENT)/ClientSDL.hpp
H_GAMECONTROLLER	= $(CLIENT)/GameController.hpp
H_GAMEWINDOW		= $(CLIENT)/GameWindow.hpp

H_CLIENTSDL		+= $(H_COMMONSDL)
H_GAMEWINDOW		+= $(H_SDL)
H_GAMECONTROLLER	+= $(H_GAMEWINDOW) $(H_CLIENTNETWORK)
